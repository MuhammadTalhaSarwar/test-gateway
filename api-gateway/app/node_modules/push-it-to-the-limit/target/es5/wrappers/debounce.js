"use strict";var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var o,t=1,n=arguments.length;t<n;t++)for(var i in o=arguments[t])Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i]);return e},__assign.apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.debounce=exports.DEFAULT_OPTS=void 0;var common_1=require("../common"),limiter_1=require("../limiter");exports.DEFAULT_OPTS={leading:!1,trailing:!0},exports.debounce=(0,common_1.adapter)((function(e,o){var t,n,i,r,c=__assign(__assign({},exports.DEFAULT_OPTS),o),a=c.delay,s=c.limit,u=c.context,l=c.rejectOnCancel,m=c.maxWait,f=c.leading,_=c.order,d=c.limiter||new limiter_1.Limiter((0,common_1.normalizeDelay)(s||a)),p=[],v=[],g=function(){v.forEach((function(e){return e.complete()})),v.length=0},h=function(){for(var o=[],c=0;c<arguments.length;c++)o[c]=arguments[c];(0,common_1.dropTimeout)(t),p.push(o),void 0===r&&(d.reset(),r=d.getNextQueueSize());var a=f&&r>0;if((r>0||void 0===i)&&(d.decrease(),r-=1,i=new Promise((function(o,t){v.push({complete:function(){return(0,common_1.complete)(o,e,"fifo"===_?p.shift():p.pop(),u)},fail:common_1.failOnCancel.bind(void 0,t)})}))),d.resetTtl(),t=setTimeout(h.flush,d.getNextDelay()),a){var s=i;return i=void 0,g(),s}return m&&!n&&(n=setTimeout(h.flush,m)),i};return h.flush=function(){d.reset(),i=void 0,r=void 0,g(),h.cancel()},h.cancel=function(){(0,common_1.dropTimeout)(t),(0,common_1.dropTimeout)(n),r=void 0,i=void 0,t=void 0,n=void 0,p.length=0,l&&v.forEach((function(e){return e.fail()})),v.length=0},h}));