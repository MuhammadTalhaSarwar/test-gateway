import{__decorate as t}from"tslib";import e from"bind-decorator";export{IPromise}from"@qiwi/substrate";function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r(){return(r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var i;!function(t){t.PENDING="Pending",t.FULFILLED="Fulfilled",t.REJECTED="Rejected"}(i||(i={}));var o,s,u,c,a=function(){},f=function(t,e){return Object.setPrototypeOf(t,e)},l=function(t,e){return new h(t,e)};Object.defineProperty(l,"Promise",{get:function(){return h.Promise},set:function(t){f(h.prototype,t.prototype),h.Promise=t}}),o=Symbol.toStringTag,s=Symbol.species,u=Symbol.species,c=Symbol.toStringTag;var h=function(){function t(e,n){this.state=i.PENDING,this.value=void 0,this.reason=void 0,this._resolve=void 0,this._reject=void 0;var r=void 0,o=void 0,s=t.normalizeOpts(e,n),u=s.Promise,c=s.executor;return t.contextify(new u(function(t,e){r=t,o=e,c(t,e)}),{state:i.PENDING,_P:u,_resolve:r,_reject:o})}var e,l,h,p=t.prototype;return p.resolve=function(t){return this._resolve(t),this},p.reject=function(t){return this._reject(t),this},p.then=function(e,n){return t.contextify(this,this,"then",e,n)},p.catch=function(e){return t.contextify(this,this,"catch",e)},p.finally=function(e){return this._P.prototype.finally?t.contextify(this,this,"finally",e):this.then(e).catch(e)},p.isPending=function(){return this.state===i.PENDING},p.isFulfilled=function(){return this.state===i.FULFILLED},p.isRejected=function(){return this.state===i.REJECTED},p.isResolved=function(){return!this.isPending()},t.contextify=function(t,e,n){var r,i=n?(r=e._P.prototype[n]).call.apply(r,[t].concat([].slice.call(arguments,3))):t;return Object.assign(f(this.observe(i),this.prototype),e)},t.observe=function(t){var e=t.then(function(t){return Object.assign(e,{value:t,state:i.FULFILLED}),t},function(t){throw Object.assign(e,{reason:t,state:i.REJECTED}),t});return e},t.normalizeOpts=function(e,n){void 0===n&&(n={});var i="function"==typeof e?r({},n,{executor:e}):e||n;return r({Promise:t.Promise,executor:a},i)},e=t,h=[{key:u,get:function(){return Promise}},{key:c,get:function(){return this.name}}],(l=[{key:"promise",get:function(){return this}},{key:"status",get:function(){return this.state}},{key:"result",get:function(){return this.isFulfilled()?this.value:this.isRejected()?this.reason:void 0}},{key:o,get:function(){return this.constructor.name}},{key:s,get:function(){return Promise}}])&&n(e.prototype,l),h&&n(e,h),t}();h.Promise=Promise,t([e],h.prototype,"resolve",null),t([e],h.prototype,"reject",null),l.Promise=Promise;export{h as InsideOutPromise,i as TPromiseState,l as factory};
//# sourceMappingURL=inside-out-promise.mjs.map
