var t=require("tslib"),e=require("bind-decorator"),r=require("@qiwi/substrate");function o(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var n,i=o(e);function s(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(){return(u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t}).apply(this,arguments)}exports.TPromiseState=void 0,(n=exports.TPromiseState||(exports.TPromiseState={})).PENDING="Pending",n.FULFILLED="Fulfilled",n.REJECTED="Rejected";var c,a,f,l,p=function(){},h=function(t,e){return Object.setPrototypeOf(t,e)},y=function(t,e){return new P(t,e)};Object.defineProperty(y,"Promise",{get:function(){return P.Promise},set:function(t){h(P.prototype,t.prototype),P.Promise=t}}),c=Symbol.toStringTag,a=Symbol.species,f=Symbol.species,l=Symbol.toStringTag;var P=function(){function t(e,r){this.state=exports.TPromiseState.PENDING,this.value=void 0,this.reason=void 0,this._resolve=void 0,this._reject=void 0;var o=void 0,n=void 0,i=t.normalizeOpts(e,r),s=i.Promise,u=i.executor;return t.contextify(new s(function(t,e){o=t,n=e,u(t,e)}),{state:exports.TPromiseState.PENDING,_P:s,_resolve:o,_reject:n})}var e,r,o,n=t.prototype;return n.resolve=function(t){return this._resolve(t),this},n.reject=function(t){return this._reject(t),this},n.then=function(e,r){return t.contextify(this,this,"then",e,r)},n.catch=function(e){return t.contextify(this,this,"catch",e)},n.finally=function(e){return this._P.prototype.finally?t.contextify(this,this,"finally",e):this.then(e).catch(e)},n.isPending=function(){return this.state===exports.TPromiseState.PENDING},n.isFulfilled=function(){return this.state===exports.TPromiseState.FULFILLED},n.isRejected=function(){return this.state===exports.TPromiseState.REJECTED},n.isResolved=function(){return!this.isPending()},t.contextify=function(t,e,r){var o,n=r?(o=e._P.prototype[r]).call.apply(o,[t].concat([].slice.call(arguments,3))):t;return Object.assign(h(this.observe(n),this.prototype),e)},t.observe=function(t){var e=t.then(function(t){return Object.assign(e,{value:t,state:exports.TPromiseState.FULFILLED}),t},function(t){throw Object.assign(e,{reason:t,state:exports.TPromiseState.REJECTED}),t});return e},t.normalizeOpts=function(e,r){void 0===r&&(r={});var o="function"==typeof e?u({},r,{executor:e}):e||r;return u({Promise:t.Promise,executor:p},o)},e=t,o=[{key:f,get:function(){return Promise}},{key:l,get:function(){return this.name}}],(r=[{key:"promise",get:function(){return this}},{key:"status",get:function(){return this.state}},{key:"result",get:function(){return this.isFulfilled()?this.value:this.isRejected()?this.reason:void 0}},{key:c,get:function(){return this.constructor.name}},{key:a,get:function(){return Promise}}])&&s(e.prototype,r),o&&s(e,o),t}();P.Promise=Promise,t.__decorate([i.default],P.prototype,"resolve",null),t.__decorate([i.default],P.prototype,"reject",null),y.Promise=Promise,Object.defineProperty(exports,"IPromise",{enumerable:!0,get:function(){return r.IPromise}}),exports.InsideOutPromise=P,exports.factory=y;
//# sourceMappingURL=inside-out-promise.js.map
